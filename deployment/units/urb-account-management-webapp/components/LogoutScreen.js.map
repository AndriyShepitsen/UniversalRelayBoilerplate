{"version":3,"sources":["../../../../units/urb-account-management-webapp/components/LogoutScreen.jsx"],"names":["styles","card","minWidth","LogoutScreen","props","context","_handle_onClick_Logout","UserAccount_Identifier","setState","currentOperation","loc","window","location","host","protocol","hostname","port","fetch","method","credentials","headers","body","response","json","responseData","console","log","success","errorMessage","error","message","_handle_onClick_CancelLogout","_handle_onClick_TryAgain","_handle_onClick_Continue","replace","state","classes","renderPrompt","renderCreating","renderSuccess","renderFailure","Component"],"mappings":"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","file":"LogoutScreen.js","sourcesContent":["// @flow\n\nimport AddIcon from 'material-ui-icons/Add'\nimport Button from 'material-ui/Button'\nimport Card, { CardActions, CardHeader } from 'material-ui/Card'\nimport { LinearProgress } from 'material-ui/Progress'\nimport { withStyles } from 'material-ui/styles'\nimport TextField from 'material-ui/TextField'\nimport Typography from 'material-ui/Typography'\nimport PropTypes from 'prop-types'\nimport React from 'react'\n\nimport ResponsiveContentArea from '../../urb-base-webapp/components/ResponsiveContentArea'\n\nconst styles = theme => ({\n  card: {\n    minWidth: 275,\n  },\n})\n\nclass LogoutScreen extends React.Component<\n  {\n    UserAccount_Identifier: string,\n    classes: PropTypes.object.isRequired,\n  },\n  {\n    currentOperation: 'confirm' | 'logging out' | 'success' | 'failure',\n    errorMessage: string,\n  },\n> {\n  constructor(props: Object, context: Object) {\n    super(props, context)\n\n    this.state = {\n      currentOperation: 'confirm',\n      errorMessage: '',\n    }\n  }\n\n  _handle_onClick_Logout = async () => {\n    const { UserAccount_Identifier } = this.props\n\n    this.setState({ currentOperation: 'logging out' })\n\n    try {\n      const loc = window.location\n      const host = loc.protocol + '//' + loc.hostname + ':' + loc.port\n\n      const response = await fetch(host + '/auth/logout', {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: '{}',\n      })\n\n      const responseData = await response.json()\n\n      console.log('LOGOUT USER RESPONSE')\n      console.log(responseData)\n\n      if (responseData.success) {\n        // In case of success, notify user\n        this.setState({ currentOperation: 'success' })\n      } else {\n        // In case of error, tell user what the error is\n        this.setState({ currentOperation: 'failure', errorMessage: responseData.error })\n      }\n    } catch (err) {\n      // In case response could not be received properly, tell the user\n      // In case of error, tell user what the error is\n      this.setState({\n        currentOperation: 'failure',\n        errorMessage:\n          'Did not receive proper response from server. Please try again. Message:' + err.message,\n      })\n    }\n  }\n\n  _handle_onClick_CancelLogout = () => {\n    this.setState({\n      currentOperation: 'failure',\n      errorMessage: 'User log out has been canceled',\n    })\n  }\n\n  _handle_onClick_TryAgain = () => {\n    this.setState({\n      currentOperation: 'confirm',\n      errorMessage: '',\n    })\n  }\n\n  _handle_onClick_Continue = () => {\n    location.replace('/')\n  }\n\n  renderCreating() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Creating user\" />\n        <Typography component=\"p\">Logging out. Please wait.</Typography>\n        <LinearProgress mode=\"query\" />\n        <CardActions>\n          <Button onClick={this._handle_onClick_CancelLogout}>Cancel</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderSuccess() {\n    const { classes } = this.props\n    const { errorMessage } = this.state\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Logout\" />\n        <Typography component=\"p\">You have been logged out</Typography>\n        <CardActions>\n          <Button onClick={this._handle_onClick_Continue}>Continue</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderFailure() {\n    const { classes } = this.props\n    const { errorMessage } = this.state\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Creating user\" />\n        <Typography component=\"p\">\n          Failed logging out.\n          <br />\n          Reason: {errorMessage}\n        </Typography>\n        <CardActions>\n          <Button onClick={this._handle_onClick_TryAgain}>Try Again</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderPrompt() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Log Out\" />\n        <Typography component=\"p\">\n          You are currently logged in. Are you sure you want to log out?\n        </Typography>\n        <CardActions>\n          <Button onClick={this._handle_onClick_Logout}>Yes, Log Out</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  render() {\n    const { currentOperation } = this.state\n\n    return (\n      <ResponsiveContentArea>\n        {currentOperation === 'confirm' && this.renderPrompt()}\n        {currentOperation === 'logging out' && this.renderCreating()}\n        {currentOperation === 'success' && this.renderSuccess()}\n        {currentOperation === 'failure' && this.renderFailure()}\n      </ResponsiveContentArea>\n    )\n  }\n}\n\nexport default withStyles(styles)(LogoutScreen)\n"]}