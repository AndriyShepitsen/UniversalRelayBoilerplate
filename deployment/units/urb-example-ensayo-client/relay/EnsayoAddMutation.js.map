{"version":3,"sources":["../../../../units/urb-example-ensayo-client/relay/EnsayoAddMutation.js"],"names":["mutation","sharedUpdater","store","user","EnsayosEdge","userProxy","get","id","connection","getConnection","insertEdgeAfter","nextClientMutationId","commit","environment","Ensayo_Title","Ensayo_Description","Ensayo_Content","clientMutationId","variables","input","updater","payload","getRootField","getLinkedRecord","optimisticUpdater","aEnsayo","create","setValue","setLinkedRecord"],"mappings":";;AAEA;AACA;;AAEA,GAAMA,2FAAN;;;;;;;;;;;;;;;;;;;AAmBA,QAASC,cAAT,CAAwBC,KAAxB,CAA+BC,IAA/B,CAAqCC,WAArC,CAAmD;AACjD,GAAMC,WAAYH,MAAMI,GAAN,CAAWH,KAAKI,EAAhB,CAAlB;;AAEA,GAAMC,YAAa,gCAAkBC,aAAlB;AACjBJ,SADiB;AAEjB,oBAFiB,CAAnB;;AAIA,GAAKG,UAAL,CAAkB;AAChB,gCAAkBE,eAAlB,CAAmCF,UAAnC,CAA+CJ,WAA/C;AACD;AACF;;AAED,GAAIO,sBAAuB,CAA3B;;AAEA,QAASC,OAAT;AACEC,WADF;AAEEV,IAFF;AAGEW,YAHF;AAIEC,kBAJF;AAKEC,cALF;AAME;AACA,GAAMC,kBAAmBN,sBAAzB;;AAEA,MAAO,+BAAgBE,WAAhB,CAA6B;AAClCb,iBADkC;AAElCkB,UAAW;AACTC,MAAO;AACLL,yBADK;AAELC,qCAFK;AAGLC,6BAHK;AAILC,iCAJK,CADE,CAFuB;;;;AAWlCG,OAXkC,kBAWzBlB,KAXyB,CAWjB;AACf,GAAMmB,SAAUnB,MAAMoB,YAAN,CAAoB,WAApB,CAAhB;AACArB,cAAeC,KAAf,CAAsBC,IAAtB,CAA4BkB,QAAQE,eAAR,CAAyB,aAAzB,CAA5B;AACD,CAdiC;;AAgBlCC,iBAhBkC,4BAgBftB,KAhBe,CAgBP;AACzB,GAAMK,+BAAgCU,gBAAtC;AACA,GAAMQ,SAAUvB,MAAMwB,MAAN,CAAcnB,EAAd,CAAkB,QAAlB,CAAhB;AACAkB,QAAQE,QAAR,CAAkBb,YAAlB,CAAgC,cAAhC;AACAW,QAAQE,QAAR,CAAkBZ,kBAAlB,CAAsC,oBAAtC;AACAU,QAAQE,QAAR,CAAkBX,cAAlB,CAAkC,gBAAlC;AACAS,QAAQE,QAAR,CAAkBpB,EAAlB,CAAsB,IAAtB;;AAEA,GAAMH,aAAcF,MAAMwB,MAAN;AACcT,gBADd;AAElB,aAFkB,CAApB;;AAIAb,YAAYwB,eAAZ,CAA6BH,OAA7B,CAAsC,MAAtC;;AAEAxB,cAAeC,KAAf,CAAsBC,IAAtB,CAA4BC,WAA5B;AACD,CA/BiC,CAA7B,CAAP;;AAiCD,C;;AAEc,CAAEQ,aAAF,C","file":"EnsayoAddMutation.js","sourcesContent":["// @flow weak\n\nimport { commitMutation, graphql } from 'react-relay'\nimport { ConnectionHandler } from 'relay-runtime'\n\nconst mutation = graphql`\n  mutation EnsayoAddMutation($input: EnsayoAddInput!) {\n    EnsayoAdd(input: $input) {\n      Viewer {\n        id\n      }\n      EnsayosEdge {\n        cursor\n        node {\n          id\n          Ensayo_Title\n          Ensayo_Description\n          Ensayo_Content\n        }\n      }\n    }\n  }\n`\n\nfunction sharedUpdater( store, user, EnsayosEdge ) {\n  const userProxy = store.get( user.id )\n\n  const connection = ConnectionHandler.getConnection(\n    userProxy,\n    'EnsayoList_Ensayos'\n  )\n  if ( connection ) {\n    ConnectionHandler.insertEdgeAfter( connection, EnsayosEdge )\n  }\n}\n\nlet nextClientMutationId = 0\n\nfunction commit(\n  environment,\n  user,\n  Ensayo_Title,\n  Ensayo_Description,\n  Ensayo_Content\n) {\n  const clientMutationId = nextClientMutationId++\n\n  return commitMutation( environment, {\n    mutation,\n    variables: {\n      input: {\n        Ensayo_Title,\n        Ensayo_Description,\n        Ensayo_Content,\n        clientMutationId,\n      },\n    },\n\n    updater( store ) {\n      const payload = store.getRootField( 'EnsayoAdd' )\n      sharedUpdater( store, user, payload.getLinkedRecord( 'EnsayosEdge' ) )\n    },\n\n    optimisticUpdater( store ) {\n      const id = `client:EnsayoAdd:Ensayo:${clientMutationId}`\n      const aEnsayo = store.create( id, 'Ensayo' )\n      aEnsayo.setValue( Ensayo_Title, 'Ensayo_Title' )\n      aEnsayo.setValue( Ensayo_Description, 'Ensayo_Description' )\n      aEnsayo.setValue( Ensayo_Content, 'Ensayo_Content' )\n      aEnsayo.setValue( id, 'id' )\n\n      const EnsayosEdge = store.create(\n        `client:EnsayoAdd:EnsayosEdge:${clientMutationId}`,\n        'EnsayosEdge'\n      )\n      EnsayosEdge.setLinkedRecord( aEnsayo, 'node' )\n\n      sharedUpdater( store, user, EnsayosEdge )\n    },\n  })\n}\n\nexport default { commit }\n"]}