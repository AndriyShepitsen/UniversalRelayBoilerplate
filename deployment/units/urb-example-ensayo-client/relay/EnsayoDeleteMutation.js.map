{"version":3,"sources":["../../../../units/urb-example-ensayo-client/relay/EnsayoDeleteMutation.js"],"names":["mutation","sharedUpdater","store","user","deletedId","userProxy","get","id","connection","getConnection","deleteNode","commit","environment","aEnsayo","variables","input","updater","payload","getRootField","getValue","optimisticUpdater"],"mappings":";;AAEA;AACA;;AAEA,GAAMA,8FAAN;;;;;;;;AAQA,QAASC,cAAT,CAAwBC,KAAxB,CAA+BC,IAA/B,CAAqCC,SAArC,CAAiD;AAC/C,GAAMC,WAAYH,MAAMI,GAAN,CAAWH,KAAKI,EAAhB,CAAlB;;AAEA,GAAMC,YAAa,gCAAkBC,aAAlB;AACjBJ,SADiB;AAEjB,oBAFiB,CAAnB;;AAIA,GAAKG,UAAL,CAAkB;AAChB,gCAAkBE,UAAlB,CAA8BF,UAA9B,CAA0CJ,SAA1C;AACD;AACF;;AAED,QAASO,OAAT,CAAiBC,WAAjB,CAA8BT,IAA9B,CAAoCU,OAApC,CAA8C;AAC5C,MAAO,+BAAgBD,WAAhB,CAA6B;AAClCZ,iBADkC;AAElCc,UAAW;AACTC,MAAO,CAAER,GAAIM,QAAQN,EAAd,CADE,CAFuB;;;AAMlCS,OANkC,kBAMzBd,KANyB,CAMjB;AACf,GAAMe,SAAUf,MAAMgB,YAAN,CAAoB,cAApB,CAAhB;AACAjB,cAAeC,KAAf,CAAsBC,IAAtB,CAA4Bc,QAAQE,QAAR,CAAkB,WAAlB,CAA5B;AACD,CATiC;;AAWlCC,iBAXkC,4BAWflB,KAXe,CAWP;AACzBD,cAAeC,KAAf,CAAsBC,IAAtB,CAA4BU,QAAQN,EAApC;AACD,CAbiC,CAA7B,CAAP;;AAeD,C;;AAEc,CAAEI,aAAF,C","file":"EnsayoDeleteMutation.js","sourcesContent":["// @flow weak\n\nimport { commitMutation, graphql } from 'react-relay'\nimport { ConnectionHandler } from 'relay-runtime'\n\nconst mutation = graphql`\n  mutation EnsayoDeleteMutation($input: EnsayoDeleteInput!) {\n    EnsayoDelete(input: $input) {\n      deletedId\n    }\n  }\n`\n\nfunction sharedUpdater( store, user, deletedId ) {\n  const userProxy = store.get( user.id )\n\n  const connection = ConnectionHandler.getConnection(\n    userProxy,\n    'EnsayoList_Ensayos'\n  )\n  if ( connection ) {\n    ConnectionHandler.deleteNode( connection, deletedId )\n  }\n}\n\nfunction commit( environment, user, aEnsayo ) {\n  return commitMutation( environment, {\n    mutation,\n    variables: {\n      input: { id: aEnsayo.id },\n    },\n\n    updater( store ) {\n      const payload = store.getRootField( 'EnsayoDelete' )\n      sharedUpdater( store, user, payload.getValue( 'deletedId' ) )\n    },\n\n    optimisticUpdater( store ) {\n      sharedUpdater( store, user, aEnsayo.id )\n    },\n  })\n}\n\nexport default { commit }\n"]}